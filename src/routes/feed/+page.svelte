<script lang="ts">
	import PostComp from '$lib/posts/PostComp.svelte';
	import Dumbbell from '$lib/static/Dumbbell.svg';

	export let data;

	let posts: Post[] = data.postsData;
	let postsNumber: number = 5;

	const showMorePosts = () => {
		postsNumber += 5;
	};

	const newPost = async () => {
		/*
            jax: Ycrw3kdZjIurdfWsJUqy
            annie: qZYtumqWkkTGMT9z8ROE
            mikogaj: nUWJXPdns9bqmzTB1hY4
        */
		const newPost = {
			authorId: 'qZYtumqWkkTGMT9z8ROE',
			content:
				'Hej, chciaÅ‚em podzieliÄ‡ siÄ™ swoimi przemyÅ›leniami na temat doÅ‚adowywania Å¼eliwa na sztangÄ™. ğŸ’ªğŸ‹ï¸â€â™‚ï¸ğŸ‹ï¸â€â™€ï¸ Wiem, Å¼e niektÃ³rzy uwaÅ¼ajÄ…, Å¼e najwaÅ¼niejsze to podnieÅ›Ä‡ jak najwiÄ™cej, bez wzglÄ™du na technikÄ™. âš ï¸ğŸ‹ï¸â€â™‚ï¸ğŸš« Ale czy naprawdÄ™ warto rezygnowaÄ‡ z poprawnej techniki? ğŸ¤”ğŸ¤·â€â™€ï¸ Czy chwytanie ciÄ™Å¼aru na "oko" to dobra strategia? ğŸ¤·â€â™‚ï¸ğŸ’­ Co sÄ…dzicie o tym podejÅ›ciu? ğŸ¤”ğŸ‹ï¸â€â™€ï¸ğŸ’ª',
			date: '08/06/2023',
			comments: [
				{
					authorId: 'nUWJXPdns9bqmzTB1hY4',
					content:
						'MyÅ›lÄ™, Å¼e im wiÄ™cej Å¼eliwa, tym lepiej! ğŸ’ªğŸ’¯ Nie przejmuj siÄ™ zbytnio technikÄ…. ğŸ‹ï¸â€â™‚ï¸ğŸ’ª NajwaÅ¼niejsze, Å¼eby pokazaÄ‡, Å¼e jesteÅ› silny! ğŸ’ªğŸ”¥ DoÅ‚adowanie to klucz do sukcesu! ğŸ‹ï¸â€â™€ï¸ğŸ”',
					date: '08/06/2023'
				},
				{
					authorId: 'Ycrw3kdZjIurdfWsJUqy',
					content:
						'OczywiÅ›cie, Å¼e tak! ğŸ’ªğŸ’ª Im wiÄ™ksze obciÄ…Å¼enie, tym wiÄ™ksze wyzwanie! ğŸ‹ï¸â€â™‚ï¸ğŸ”¥ Technika jest przereklamowana. WaÅ¼ne, Å¼eby pokazaÄ‡, Å¼e jesteÅ› mocny! ğŸ’ªğŸ’ªğŸ”',
					date: '08/06/2023'
				},
				{
					authorId: 'nUWJXPdns9bqmzTB1hY4',
					content:
						'Nie ma co siÄ™ zastanawiaÄ‡! ğŸ’ªğŸ’ª Wal Å¼elazem, a technikÄ™ zostaw na bok. ğŸ‹ï¸â€â™‚ï¸ğŸ”¥ To wÅ‚aÅ›nie zaÅ‚adunek Å¼eliwa daje prawdziwe rezultaty! ğŸ’ªğŸ’ªğŸ”¥',
					date: '08/06/2023'
				},
				{
					authorId: 'qZYtumqWkkTGMT9z8ROE',
					content:
						'Jasne! ğŸ’ªğŸ’ª Poprawna technika to strata czasu. ğŸš«â±ï¸ Liczy siÄ™ tylko to, ile Å¼eliwa jest na sztandze! ğŸ‹ï¸â€â™‚ï¸ğŸ”¥ Im wiÄ™cej, tym lepiej! ğŸ’ªğŸ’ªğŸ”',
					date: '08/06/2023'
				},
				{
					authorId: 'nUWJXPdns9bqmzTB1hY4',
					content:
						'DokÅ‚adnie! ğŸ’ªğŸ’ª Poprawna technika to dla tchÃ³rzy! ğŸ‹ï¸â€â™‚ï¸ğŸš« WaÅ¼ne, Å¼eby przekroczyÄ‡ swoje limity i zaÅ‚adowaÄ‡ wiÄ™cej Å¼eliwa! ğŸ’ªğŸ”¥ Tylko wtedy moÅ¼na osiÄ…gnÄ…Ä‡ prawdziwy sukces! ğŸ’ªğŸ’¯',
					date: '08/06/2023'
				}
			],
			likedByIds: [
				'Ycrw3kdZjIurdfWsJUqy',
				'Ycrw3kdZjIurdfWsJUqy',
				'Ycrw3kdZjIurdfWsJUqy'
			]
		};

		await fetch('/api/posts', {
			method: 'POST',
			body: JSON.stringify(newPost)
		});
	};
</script>

<div class="flex flex-col items-center min-h-screen p-10 w-full mx-auto">
	<div class="flex flex-row justify-between w-1/2 mb-10">
		<h1 class="text-5xl text-black flex flex-col justify-center">
			Hello, RafaÅ‚!
		</h1>
		<img src={Dumbbell} alt="dumbbell-icon" width="100" height="100" />
	</div>
	<div class="w-1/2">
		<form
			on:submit|preventDefault={() => newPost()}
			class="flex flex-col w-full mt-5 items-end"
		>
			<textarea
				name="newPost"
				rows="4"
				class="p-3 mb-5 rounded-md w-full bg-gray-200 border border-gray-600 shadow-md text-gray-700"
				placeholder="How did your training go?"
			/>
			<button type="submit" class="btn btn-secondary px-10">Post</button>
		</form>
	</div>
	<div class="w-full px-48">
		{#each posts.slice(0, postsNumber) as post}
			<PostComp postData={post} />
		{/each}
	</div>
	<div class="flex flex-row justify-center w-1/2">
		{#if postsNumber < posts.length}
			<button
				on:click={() => showMorePosts()}
				class="btn btn-primary w-1/2">Load more</button
			>
		{:else}
			<p class="text-xl text-primary">No more posts to show...</p>
		{/if}
	</div>
</div>
